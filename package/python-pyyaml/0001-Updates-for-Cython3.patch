From 0a82f25dbc810d48063281c8db02ff517cee077a Mon Sep 17 00:00:00 2001
From: Refael Ackermann <me@refack.com>
Date: Wed, 30 Aug 2023 14:56:32 -0400
Subject: [PATCH] Compatibility with Cython 3.0

---
 pyproject.toml | 2 +-
 setup.py       | 5 ++++-
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/pyproject.toml b/pyproject.toml
index 4bc04c0d..2bf5ec80 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -1,3 +1,3 @@
 [build-system]
-requires = ["setuptools", "wheel", "Cython<3.0"]
+requires = ["setuptools", "wheel", "Cython"]
 build-backend = "setuptools.build_meta"
diff --git a/setup.py b/setup.py
index 65b0ea0e..b14c1738 100644
--- a/setup.py
+++ b/setup.py
@@ -82,7 +82,10 @@
     with_cython = True
 try:
     from Cython.Distutils.extension import Extension as _Extension
-    from Cython.Distutils import build_ext as _build_ext
+    try:
+        from Cython.Distutils.old_build_ext import old_build_ext as _build_ext
+    except ImportError:
+        from Cython.Distutils import build_ext as _build_ext
     with_cython = True
 except ImportError:
     if with_cython:
